<!DOCTYPE html>
<html lang="en">
  <!-- Beautiful Jekyll | MIT license | Copyright Dean Attali 2016 -->
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, viewport-fit=cover">

  <title>Simple Automation</title>

  <meta name="author" content="Sakshay Mahna" />

  

  <link rel="alternate" type="application/rss+xml" title="Progress Blog - -- JDE Robotics" href="/colab-Sakshay_Mahna/feed.xml" />

  

  

  


  
    
      
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.0/css/font-awesome.min.css" />


    
  

  
    
      <link rel="stylesheet" href="/colab-Sakshay_Mahna/css/bootstrap.min.css" />
    
      <link rel="stylesheet" href="/colab-Sakshay_Mahna/css/bootstrap-social.css" />
    
      <link rel="stylesheet" href="/colab-Sakshay_Mahna/css/main.css" />
    
  

  
    
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
    
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
    
  

  

  

  

    <!-- Facebook OpenGraph tags -->
  

  
  <meta property="og:title" content="Simple Automation" />
  

   
  <meta property="og:description" content="Automation is the technology by which a process can be carried out with minimal human assistance. Automation can be hardware or software based. In this post we are going to talk about a software based web automation process using the python library Selenium. Far off in the future, maybe? This...">
  


  <meta property="og:type" content="website" />

  
  <meta property="og:url" content="http://localhost:4000/2020-01-26-simple-automation/" />
  <link rel="canonical" href="http://localhost:4000/2020-01-26-simple-automation/" />
  

  
  <meta property="og:image" content="http://localhost:4000/img/logo.png" />
  


  <!-- Twitter summary cards -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@" />
  <meta name="twitter:creator" content="@" />

  
  <meta name="twitter:title" content="Simple Automation" />
  

  
  <meta name="twitter:description" content="Automation is the technology by which a process can be carried out with minimal human assistance. Automation can be hardware or software based. In this post we are going to talk about a software based web automation process using the python library Selenium. Far off in the future, maybe? This...">
  

  
  <meta name="twitter:image" content="http://localhost:4000/img/logo.png" />
  

  

  

</head>


  <body>

    

  
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
        <a class="navbar-brand" href="http://localhost:4000">Progress Blog</a>
      
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
      
        
          <li>
            






<a href="/colab-Sakshay_Mahna/aboutme">About Me</a>

          </li>
        
        
      </ul>
    </div>

	
	<div class="avatar-container">
	  <div class="avatar-img-border">
	    <a href="http://localhost:4000">
	      <img class="avatar-img" src="/colab-Sakshay_Mahna/img/logo.png" />
		</a>
	  </div>
	</div>
	

  </div>
</nav>


    <!-- TODO this file has become a mess, refactor it -->





<header class="header-section ">

<div class="intro-header no-img">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-heading">
          <h1>Simple Automation</h1>
		  
		  
		  
		  <span class="post-meta">Posted on January 26, 2020</span>
		  
        </div>
      </div>
    </div>
  </div>
</div>
</header>





<div class="container">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

      

      <article role="main" class="blog-post">
        <p>Automation is the technology by which a process can be carried out with minimal human assistance. Automation can be hardware or software based. In this post we are going to talk about a software based web automation process using the python library Selenium.</p>

<p><img src="../assets/automation.gif" alt="Automation" /></p>

<p><em>Far off in the future, maybe?</em></p>

<p><img src="../assets/automation1.gif" alt="Automation" /></p>

<p><em>This is cool!</em></p>

<h3 id="selenium-and-its-functions">Selenium and its Functions</h3>
<p>As the name suggests, manipulating data from a web source is called <strong>Web Automation</strong>. It can include anything like sending emails, messages and even deleting those emails and messages. Automatic <strong>Data Scraping</strong> is another great example of Web Automation. Selenium is a powerful tool for controlling web browser through computer program. The automation scripts can be written in various languages, and run for various browsers. All those simple web automation tasks can be simply acheived in minimal amount of code using the Selenium Library.</p>

<p>Possiblities with Selenium are endless! So, let’s keep our circle small. We are going to discuss Automatic Whatsapp Messaging, on Google Chrome Browser using Python Language as a test example to use Selenium.</p>

<h3 id="installation">Installation</h3>
<p>First of all, install the python bindings of Selenium. This will make the selenium library ready to be used in our python code.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip install selenium
</code></pre></div></div>

<p>Selenium requires a web driver to interface with the chosen browser. A simple google search may yield the required drivers for a particular web browsers. Here are the links for <a href="https://sites.google.com/a/chromium.org/chromedriver/downloads">Chrome</a>, <a href="https://github.com/mozilla/geckodriver/releases">FireFox</a>, <a href="https://webkit.org/blog/6900/webdriver-support-in-safari-10/">Safari</a>.</p>

<h3 id="the-code">The Code</h3>

<h4 id="importing-libraries">Importing Libraries</h4>
<p>Import all these libraries, the function of each will be explained as we go along.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support.ui</span> <span class="kn">import</span> <span class="n">WebDriverWait</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support</span> <span class="kn">import</span> <span class="n">expected_conditions</span> <span class="k">as</span> <span class="n">EC</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="kn">import</span> <span class="n">Keys</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>
<span class="kn">import</span> <span class="nn">time</span>
</code></pre></div></div>

<h4 id="import-the-web-driver">Import the Web Driver</h4>
<p>Get the path of the web driver wherever it is on your local system. A much simpler way would be by placing the script and the driver in the same folder. In which case, you will have the address <code class="highlighter-rouge">./driver_name</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="s">'Path of Web Driver goes here'</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="set-the-web-address">Set the web address</h4>
<p>Set the website address, of the webpage we want to automate. In our case, it is the WhatsApp Web. In case, you have never used the Web Service, upon starting it, we have to scan a QR Code to allow the Web Service to be active. The other command <code class="highlighter-rouge">WebDriverWait</code> is going to wait until we scan the code from our phone. Followed by that, we have <code class="highlighter-rouge">time.sleep(2)</code> to wait until we get the chat screen.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"https://web.whatsapp.com/"</span><span class="p">)</span>
<span class="n">wait</span> <span class="o">=</span> <span class="n">WebDriverWait</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="../assets/whatsapp.png" alt="Chat Screen" /></p>

<p><em>WhatsApp Web</em></p>

<h4 id="scrapping-elements-from-html">Scrapping elements from HTML</h4>
<p>This is the toughest part of any Selenium Project. In order to scrape any data from the webpage, we need to know its location, and location is determined through HTML. To navigate through the HTML document of the Webpage, we use what is called XPATH. XPATH stands for XML Path Language. As the name suggests, it is used to navigate through XML files. XPATH being a vast topic, let us confine ourselves to just building the Message Automater. In case, somebody feels curious, here is a <a href="https://www.w3schools.com/xml/xpath_intro.asp">wonderful link</a> to learn about it. Another <a href="https://www.google.com">wonderful link</a> for the over curious ones!</p>

<p>For our purpose, we need to select the Contact from Contact Pane, to whom we want to message, and get the text box, in the Message Pane, to type our message.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">target</span> <span class="o">=</span> <span class="s">'Your Contact Name goes here!'</span>

<span class="n">x_arg</span> <span class="o">=</span> <span class="s">'//span[@title="'</span> <span class="o">+</span> <span class="n">target</span> <span class="o">+</span> <span class="s">'"]'</span> <span class="c">#XPATH</span>
<span class="n">group_title</span> <span class="o">=</span> <span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">x_arg</span><span class="p">)))</span>
<span class="n">group_title</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

<span class="n">inp_xpath</span> <span class="o">=</span> <span class="s">"//div[@contenteditable='true']"</span>    <span class="c">#XAPTH</span>
<span class="n">input_box</span> <span class="o">=</span> <span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">inp_xpath</span><span class="p">)))</span>
</code></pre></div></div>

<p>The above XPATH <code class="highlighter-rouge">//span[@title='']</code> aims to find an HTML tag called span, with title attribute equal to the target name, and the other one <code class="highlighter-rouge">//div[@contenteditable='true']</code> aims to find an HTML tag called div, with contenteditable attribute equal to true. Other commands are pretty self explanatory!</p>

<p><img src="../assets/HTML.png" alt="HTML Mining" /></p>

<p><em>Take care that your contact names do not have emojis, otherwise it is difficult to pinpoint them!</em></p>

<p>Here is the catch, in order to make our driver application possible, we require HTML tags that are unique in one way or another. A tag may be unique as a tag itself, or a unique attribute value. Now, it may be easy to understand, why it’s the <strong>toughest part</strong>. We have to manually search through the HTML document of the website to find <strong>uniqueness in data</strong>. The more unique the tag we want to interact with, the easier our job becomes! Some times it can be as easy as finding an <code class="highlighter-rouge">input</code> tag because the webpage has only one input tag.</p>

<p>XPATH is the one making our job easier in this case. So, knowing XPATH is a good way to go!</p>

<h4 id="automatic-typing">Automatic Typing</h4>
<p>I originally made the script to prank people by spamming them. Well, as a result, your contact is blocked by the other person, you are trying to mess with!</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">string</span> <span class="o">=</span> <span class="s">"Your message goes here!"</span>

<span class="c">#The prank version 5300 messages</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5300</span><span class="p">):</span>
    <span class="n">input_box</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">string</span> <span class="o">+</span> <span class="n">Keys</span><span class="o">.</span><span class="n">ENTER</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div>

<p>Regular users of the Web Service would have noticed that upon pressing ENTER key, the message gets sent. This is exploited in the above snippet, the Keys.ENTER virtually presses the ENTER key after the string is inserted in the text box.</p>

<p><code class="highlighter-rouge">time.sleep(2)</code> plays a major role here. It halts our program until Selenium can type the message in the <code class="highlighter-rouge">input_box</code>. Too little a time, and our message gets sent in chunks, or not at all. Too long, and our prank becomes useless! Also, as a general note, <code class="highlighter-rouge">time.sleep()</code> is a crucial part of any Selenium Project. Some websites, can block our IPs if we continously keep pinging the servers. So, a correct balance of halt is a necessary part!</p>

<p><img src="../assets/prank.gif" alt="Illustration" /></p>

<p><em>Devil Laugh</em></p>

<h3 id="final-remarks">Final Remarks</h3>

<p><img src="../assets/spam.jpg" alt="Prank Meme" /></p>

<p><em>How to stop spamming!</em></p>

<p>So, this is it! That’s how you can spam people, with some simple code <strong>#NotoriousProgramming</strong>. As can be seen, making Selenium based automation scripts are easy to do if you know what you are doing. There are a lot of possibilties with these scripts. So, go out there and explore those!</p>


      </article>

      

      
        <!-- Check if any share-links are active -->




<section id = "social-share-section">
  <span class="sr-only">Share: </span>

  
  <!--- Share on Twitter -->
    <a href="https://twitter.com/intent/tweet?text=Simple+Automation+http://localhost:4000/2020-01-26-simple-automation/"
      class="btn btn-social-icon btn-twitter" title="Share on Twitter">
      <span class="fa fa-fw fa-twitter" aria-hidden="true"></span>
      <span class="sr-only">Twitter</span>
    </a>
  

  
  <!--- Share on Facebook -->
    <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/2020-01-26-simple-automation/"
      class="btn btn-social-icon btn-facebook" title="Share on Facebook">
      <span class="fa fa-fw fa-facebook" aria-hidden="true"></span>
      <span class="sr-only">Facebook</span>
    </a>
  

  

  
  <!--- Share on LinkedIn -->
    <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/2020-01-26-simple-automation/"
      class="btn btn-social-icon btn-linkedin" title="Share on LinkedIn">
      <span class="fa fa-fw fa-linkedin" aria-hidden="true"></span>
      <span class="sr-only">LinkedIn</span>
    </a>
  

</section>



      

      <ul class="pager blog-pager">
        
        <li class="previous">
          <a href="/colab-Sakshay_Mahna/2020-01-11-coverage-algorithms-part-2/" data-toggle="tooltip" data-placement="top" title="Coverage Algorithms - Part 2">&larr; Previous Post</a>
        </li>
        
        
        <li class="next">
          <a href="/colab-Sakshay_Mahna/2020-02-10-competitive-robotics/" data-toggle="tooltip" data-placement="top" title="Competitive Robotics">Next Post &rarr;</a>
        </li>
        
      </ul>

      
        <div class="disqus-comments">
          
        </div>
          
        <div class="staticman-comments">
          

        </div>
        <div class="justcomments-comments">
          
        </div>
      
    </div>
  </div>
</div>


    <footer>
  <div class="container beautiful-jekyll-footer">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links"><li><a href="/colab-Sakshay_Mahna/feed.xml" title="RSS"><span class="fa-stack fa-lg" aria-hidden="true">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                </span>
                <span class="sr-only">RSS</span>
              </a>
            </li><li><a href="mailto:sakshum19@gmail.com" title="Email me"><span class="fa-stack fa-lg" aria-hidden="true">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                </span>
                <span class="sr-only">Email me</span>
              </a>
            </li><li><a href="https://github.com/SakshayMahna" title="GitHub"><span class="fa-stack fa-lg" aria-hidden="true">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                </span>
                <span class="sr-only">GitHub</span>
              </a>
            </li><li><a href="https://twitter.com/MahnaSakshay" title="Twitter"><span class="fa-stack fa-lg" aria-hidden="true">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                </span>
                <span class="sr-only">Twitter</span>
              </a>
            </li><li><a href="https://linkedin.com/in/sakshaymahna" title="LinkedIn"><span class="fa-stack fa-lg" aria-hidden="true">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                </span>
                <span class="sr-only">LinkedIn</span>
              </a>
            </li></ul>
      <p class="copyright text-muted">
      Sakshay Mahna
      &nbsp;&bull;&nbsp;
      2020

      

      
      </p>
          <!-- Please don't remove this, keep my open source work credited :) -->
    <p class="theme-by text-muted">
      Theme by
      <a href="https://deanattali.com/beautiful-jekyll/">beautiful-jekyll</a>
    </p>
      </div>
    </div>
  </div>
</footer>

  
    






  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script>
      	if (typeof jQuery == 'undefined') {
      	  document.write('<script src="/colab-Sakshay_Mahna/js/jquery-1.11.2.min.js"></scr' + 'ipt>');
      	}
      </script>
    
  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
	<script src="/colab-Sakshay_Mahna/js/bootstrap.min.js"></script>
    
  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
	<script src="/colab-Sakshay_Mahna/js/main.js"></script>
    
  


  
  </body>
</html>
